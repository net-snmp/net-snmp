<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>snmpd.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>snmpd.c File Reference</h1><code>#include &lt;<a class="el" href="config_8h-source.html">config.h</a>&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;netinet/in.h&gt;</code><br>
<code>#include &lt;arpa/inet.h&gt;</code><br>
<code>#include &lt;sys/time.h&gt;</code><br>
<code>#include &lt;time.h&gt;</code><br>
<code>#include &lt;sys/select.h&gt;</code><br>
<code>#include &lt;sys/socket.h&gt;</code><br>
<code>#include &lt;net/if.h&gt;</code><br>
<code>#include &lt;sys/ioctl.h&gt;</code><br>
<code>#include &lt;sys/file.h&gt;</code><br>
<code>#include &lt;fcntl.h&gt;</code><br>
<code>#include &lt;sys/wait.h&gt;</code><br>
<code>#include &lt;signal.h&gt;</code><br>
<code>#include &lt;sys/param.h&gt;</code><br>
<code>#include &lt;dmalloc.h&gt;</code><br>
<code>#include "asn1.h"</code><br>
<code>#include "snmp_api.h"</code><br>
<code>#include "snmp_impl.h"</code><br>
<code>#include "system.h"</code><br>
<code>#include "read_config.h"</code><br>
<code>#include "snmp.h"</code><br>
<code>#include "mib.h"</code><br>
<code>#include "<a class="el" href="m2m_8h-source.html">m2m.h</a>"</code><br>
<code>#include "<a class="el" href="snmp__vars_8h-source.html">snmp_vars.h</a>"</code><br>
<code>#include "<a class="el" href="agent__read__config_8h-source.html">agent_read_config.h</a>"</code><br>
<code>#include "snmpv3.h"</code><br>
<code>#include "callback.h"</code><br>
<code>#include "snmp_alarm.h"</code><br>
<code>#include "default_store.h"</code><br>
<code>#include "<a class="el" href="mib__module__config_8h-source.html">mib_module_config.h</a>"</code><br>
<code>#include "snmp_client.h"</code><br>
<code>#include "<a class="el" href="snmpd_8h-source.html">snmpd.h</a>"</code><br>
<code>#include "<a class="el" href="agent__handler_8h-source.html">agent_handler.h</a>"</code><br>
<code>#include "<a class="el" href="var__struct_8h-source.html">var_struct.h</a>"</code><br>
<code>#include "mibgroup/struct.h"</code><br>
<code>#include "snmp_debug.h"</code><br>
<code>#include "<a class="el" href="mib__modules_8h-source.html">mib_modules.h</a>"</code><br>
<code>#include "snmp_secmod.h"</code><br>
<code>#include "snmpusm.h"</code><br>
<code>#include "tools.h"</code><br>
<code>#include "lcd_time.h"</code><br>
<code>#include "mibgroup/util_funcs.h"</code><br>
<code>#include "<a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>"</code><br>
<code>#include "<a class="el" href="agent__trap_8h-source.html">agent_trap.h</a>"</code><br>
<code>#include "<a class="el" href="ds__agent_8h-source.html">ds_agent.h</a>"</code><br>
<code>#include "snmp_logging.h"</code><br>
<code>#include "snmp_transport.h"</code><br>
<code>#include "<a class="el" href="version_8h-source.html">version.h</a>"</code><br>
<code>#include &lt;<a class="el" href="table_8h-source.html">helpers/table.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="table__iterator_8h-source.html">helpers/table_iterator.h</a>&gt;</code><br>
<code>#include "mib_module_includes.h"</code><br>
<code>#include "mib_module_shutdown.h"</code><br>

<p>
<a href="snmpd_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a0">NFDBITS</a>&nbsp;&nbsp;&nbsp;(sizeof(<a class="el" href="snmpd_8c.html#a8">fd_mask</a>) * NBBY)</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a1">FD_SET</a>(n, p)&nbsp;&nbsp;&nbsp;((p)-&gt;fds_bits[(n)/NFDBITS] |= (1 &lt;&lt; ((n) % NFDBITS)))</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a2">FD_CLR</a>(n, p)&nbsp;&nbsp;&nbsp;((p)-&gt;fds_bits[(n)/NFDBITS] &amp;= ~(1 &lt;&lt; ((n) % NFDBITS)))</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a3">FD_ISSET</a>(n, p)&nbsp;&nbsp;&nbsp;((p)-&gt;fds_bits[(n)/NFDBITS] &amp; (1 &lt;&lt; ((n) % NFDBITS)))</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a4">FD_ZERO</a>(p)&nbsp;&nbsp;&nbsp;memset((p), 0, sizeof(*(p)))</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a5">TIMETICK</a>&nbsp;&nbsp;&nbsp;500000L</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a6">ONE_SEC</a>&nbsp;&nbsp;&nbsp;1000000L</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a7">NUM_SOCKETS</a>&nbsp;&nbsp;&nbsp;32</td></tr>
<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td nowrap align=right valign=top>typedef long&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a8">fd_mask</a></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a15">snmp_read_packet</a> (int)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a16">snmp_input</a> (int, struct snmp_session *, int, struct snmp_pdu *, void *)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a18">main</a> (int, char **)</td></tr>
<tr><td nowrap align=right valign=top>RETSIGTYPE&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a21">SnmpdShutDown</a> (int a)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a22">main</a> (int argc, char *argv[])</td></tr>
<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a9">snmp_dump_packet</a></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a10">running</a> = 1</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a11">reconfig</a> = 0</td></tr>
<tr><td nowrap align=right valign=top>char **&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a12">argvrestartp</a></td></tr>
<tr><td nowrap align=right valign=top>char *&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a13">argvrestart</a></td></tr>
<tr><td nowrap align=right valign=top>char *&nbsp;</td><td valign=bottom><a class="el" href="snmpd_8c.html#a14">argvrestartname</a></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a name="a2" doxytag="snmpd.c::FD_CLR"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FD_CLR</td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>n,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>p&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md">&nbsp;&nbsp;&nbsp;((p)-&gt;fds_bits[(n)/NFDBITS] &amp;= ~(1 &lt;&lt; ((n) % NFDBITS)))
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00100">100</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.
<p>
Referenced by <a class="el" href="snmpd_8c-source.html#l00291">main</a>().
<p>
    </td>
  </tr>
</table>
<a name="a3" doxytag="snmpd.c::FD_ISSET"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FD_ISSET</td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>n,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>p&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md">&nbsp;&nbsp;&nbsp;((p)-&gt;fds_bits[(n)/NFDBITS] &amp; (1 &lt;&lt; ((n) % NFDBITS)))
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00101">101</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.
<p>
Referenced by <a class="el" href="snmpd_8c-source.html#l00291">main</a>().
<p>
    </td>
  </tr>
</table>
<a name="a1" doxytag="snmpd.c::FD_SET"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FD_SET</td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>n,         <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>p&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md">&nbsp;&nbsp;&nbsp;((p)-&gt;fds_bits[(n)/NFDBITS] |= (1 &lt;&lt; ((n) % NFDBITS)))
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00099">99</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.
<p>
Referenced by <a class="el" href="snmpd_8c-source.html#l00291">main</a>().
<p>
    </td>
  </tr>
</table>
<a name="a4" doxytag="snmpd.c::FD_ZERO"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FD_ZERO</td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>p&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md">&nbsp;&nbsp;&nbsp;memset((p), 0, sizeof(*(p)))
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00102">102</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.
<p>
Referenced by <a class="el" href="snmp__agent_8c-source.html#l00256">agent_check_and_process</a>(), and <a class="el" href="snmpd_8c-source.html#l00291">main</a>().
<p>
    </td>
  </tr>
</table>
<a name="a0" doxytag="snmpd.c::NFDBITS"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NFDBITS&nbsp;&nbsp;&nbsp;(sizeof(<a class="el" href="snmpd_8c.html#a8">fd_mask</a>) * NBBY)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00098">98</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<a name="a7" doxytag="snmpd.c::NUM_SOCKETS"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NUM_SOCKETS&nbsp;&nbsp;&nbsp;32
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00174">174</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<a name="a6" doxytag="snmpd.c::ONE_SEC"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ONE_SEC&nbsp;&nbsp;&nbsp;1000000L
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00163">163</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<a name="a5" doxytag="snmpd.c::TIMETICK"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TIMETICK&nbsp;&nbsp;&nbsp;500000L
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00162">162</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a name="a8" doxytag="snmpd.c::fd_mask"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef long fd_mask
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00097">97</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a name="a21" doxytag="snmpd.c::SnmpdShutDown"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> RETSIGTYPE SnmpdShutDown </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp; <em>a</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00243">243</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.<div class="fragment"><pre>00244 {
00245         <a class="code" href="snmpd_8c.html#a10">running</a> = 0;
00246 }
</pre></div>    </td>
  </tr>
</table>
<a name="a22" doxytag="snmpd.c::main"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int main </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>argc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00291">291</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.<div class="fragment"><pre>00292 {
00293         <font class="keywordtype">int</font>             arg, i;
00294         <font class="keywordtype">int</font>             ret;
00295         <font class="keywordtype">int</font>             dont_fork = 0;
00296         <font class="keywordtype">char</font>            logfile[SNMP_MAXBUF_SMALL];
00297         <font class="keywordtype">char</font>           *cptr, **argvptr;
00298         <font class="keywordtype">char</font>           *pid_file = NULL;
00299         <font class="keywordtype">char</font>            buf[SPRINT_MAX_LEN];
00300 <font class="preprocessor">#if HAVE_GETPID</font>
00301         FILE           *PID;
00302 <font class="preprocessor">#endif</font>
00303         <font class="keywordtype">int</font>             dont_zero_log = 0;
00304         <font class="keywordtype">int</font>             stderr_log=0, syslog_log=0;
00305         <font class="keywordtype">int</font>             uid=0, gid=0;
00306         <font class="keywordtype">int</font>             agent_mode=-1;
00307 
00308         logfile[0]              = 0;
00309 
00310 <font class="preprocessor">#ifdef LOGFILE</font>
00311         strcpy(logfile, LOGFILE);
00312 <font class="preprocessor">#endif</font>
00313 
00314 <font class="preprocessor">#ifdef NO_ROOT_ACCESS</font>
00315         <font class="comment">/* default to no */</font>
00316         ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a2">DS_AGENT_NO_ROOT_ACCESS</a>, 1);
00317 <font class="preprocessor">#endif</font>
00318                         <font class="comment">/* Default to NOT running an AgentX master */</font>
00319         ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a3">DS_AGENT_AGENTX_MASTER</a>, 0);
00320 
00321         <font class="comment">/*</font>
00322          * usage: snmpd
00323          */
00324         <font class="keywordflow">for</font> (arg = 1; arg &lt; argc; arg++)
00325           {
00326             <font class="keywordflow">if</font> (argv[arg][0] == <font class="charliteral">'-'</font>) {
00327               <font class="keywordflow">switch</font> (argv[arg][1]) {
00328 
00329                 <font class="keywordflow">case</font> <font class="charliteral">'c'</font>:
00330                   <font class="keywordflow">if</font> (++arg == argc)
00331                     usage(argv[0]);
00332                   ds_set_string(DS_LIBRARY_ID, DS_LIB_OPTIONALCONFIG,
00333                                  argv[arg]);
00334                   <font class="keywordflow">break</font>;
00335 
00336                 <font class="keywordflow">case</font> <font class="charliteral">'C'</font>:
00337                     ds_set_boolean(DS_LIBRARY_ID, DS_LIB_DONT_READ_CONFIGS, 1);
00338                     <font class="keywordflow">break</font>;
00339 
00340                 <font class="keywordflow">case</font> <font class="charliteral">'d'</font>:
00341                     snmp_set_dump_packet(++snmp_dump_packet);
00342                     ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a0">DS_AGENT_VERBOSE</a>, 1);
00343                     <font class="keywordflow">break</font>;
00344 
00345                 <font class="keywordflow">case</font> <font class="charliteral">'q'</font>:
00346                     snmp_set_quick_print(1);
00347                     <font class="keywordflow">break</font>;
00348 
00349                 <font class="keywordflow">case</font> <font class="charliteral">'T'</font>:
00350                     <font class="keywordflow">if</font> (argv[arg][2] != <font class="charliteral">'\0'</font>) 
00351                         cptr = &amp;argv[arg][2];
00352                     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (++arg&gt;argc) {
00353                         fprintf(stderr,<font class="stringliteral">"%s: Need UDP or TCP after -T flag.\n"</font>, argv[0]);
00354                         usage(argv[0]);
00355                         exit(1);
00356                     } <font class="keywordflow">else</font> {
00357                         cptr = argv[arg];
00358                     }
00359                     <font class="keywordflow">if</font> (strcasecmp(cptr,<font class="stringliteral">"TCP"</font>) == 0)<font class="keyword"> </font>{
00360                         ds_set_int(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a8">DS_AGENT_FLAGS</a>,
00361                                    ds_get_int(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a8">DS_AGENT_FLAGS</a>)
00362                                    | SNMP_FLAGS_STREAM_SOCKET);
00363                     } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (strcasecmp(cptr,<font class="stringliteral">"UDP"</font>) == 0)<font class="keyword"> </font>{
00364                         <font class="comment">/* default, do nothing */</font>
00365                     } <font class="keywordflow">else</font> {
00366                         fprintf(stderr,
00367                                 <font class="stringliteral">"%s: Unknown transport \"%s\" after -T flag.\n"</font>,
00368                                 argv[0], cptr);
00369                         usage(argv[0]);
00370                         exit(1);
00371                     }
00372                     <font class="keywordflow">break</font>;
00373 
00374                 <font class="keywordflow">case</font> <font class="charliteral">'D'</font>:
00375                     debug_register_tokens(&amp;argv[arg][2]);
00376                     snmp_set_do_debugging(1);
00377                     <font class="keywordflow">break</font>;
00378 
00379                 <font class="keywordflow">case</font> <font class="charliteral">'p'</font>:
00380                   <font class="keywordflow">if</font> (++arg == argc)
00381                     usage(argv[0]);
00382 
00383                   <font class="comment">/* has something been specified before? */</font>
00384                   cptr = ds_get_string(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a6">DS_AGENT_PORTS</a>);
00385                       
00386                   <font class="comment">/* set the specification string up */</font>
00387                   <font class="keywordflow">if</font> (cptr) {
00388                       <font class="comment">/*  Append to the older specification string.  */</font>
00389                     sprintf(buf,<font class="stringliteral">"%s,%s"</font>, cptr, argv[arg]);
00390                   } <font class="keywordflow">else</font> {
00391                     strcpy(buf,argv[arg]);
00392                   }
00393 
00394                   DEBUGMSGTL((<font class="stringliteral">"snmpd_ports"</font>,<font class="stringliteral">"port spec: %s\n"</font>, buf));
00395                   ds_set_string(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a6">DS_AGENT_PORTS</a>, buf);
00396                   <font class="keywordflow">break</font>;
00397 
00398 <font class="preprocessor">#if defined(USING_AGENTX_SUBAGENT_MODULE) || defined(USING_AGENTX_MASTER_MODULE)</font>
00399                 <font class="keywordflow">case</font> <font class="charliteral">'x'</font>:
00400                   <font class="keywordflow">if</font> (++arg == argc)
00401                     usage(argv[0]);
00402                   ds_set_string(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a5">DS_AGENT_X_SOCKET</a>, argv[arg]);
00403                   ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a3">DS_AGENT_AGENTX_MASTER</a>, 1 );
00404                   <font class="keywordflow">break</font>;
00405 <font class="preprocessor">#endif</font>
00406 
00407                 <font class="keywordflow">case</font> <font class="charliteral">'X'</font>:
00408 <font class="preprocessor">#if defined(USING_AGENTX_SUBAGENT_MODULE)</font>
00409                   agent_mode = <a class="code" href="snmpd_8h.html#a1">SUB_AGENT</a>;
00410 <font class="preprocessor">#else</font>
00411                   fprintf(stderr,<font class="stringliteral">"%s: Illegal argument -X: AgentX support not compiled in.\n"</font>, argv[0]);
00412                   usage(argv[0]);
00413                   exit(1);
00414 <font class="preprocessor">#endif</font>
00415                   <font class="keywordflow">break</font>;
00416 
00417                 <font class="keywordflow">case</font> <font class="charliteral">'r'</font>:
00418                     ds_toggle_boolean(DS_APPLICATION_ID,
00419                                       <a class="code" href="ds__agent_8h.html#a2">DS_AGENT_NO_ROOT_ACCESS</a>);
00420                     <font class="keywordflow">break</font>;
00421 
00422                 <font class="keywordflow">case</font> <font class="charliteral">'P'</font>:
00423                   <font class="keywordflow">if</font> (++arg == argc)
00424                     usage(argv[0]);
00425                   pid_file = argv[arg];
00426 
00427                 <font class="keywordflow">case</font> <font class="charliteral">'a'</font>:
00428                   log_addresses++;
00429                   <font class="keywordflow">break</font>;
00430 
00431                 <font class="keywordflow">case</font> <font class="charliteral">'V'</font>:
00432                   ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a0">DS_AGENT_VERBOSE</a>, 1);
00433                   <font class="keywordflow">break</font>;
00434 
00435                 <font class="keywordflow">case</font> <font class="charliteral">'f'</font>:
00436                   dont_fork = 1;
00437                   <font class="keywordflow">break</font>;
00438 
00439                 <font class="keywordflow">case</font> <font class="charliteral">'l'</font>:
00440                   <font class="keywordflow">if</font> (++arg == argc)
00441                     usage(argv[0]);
00442                   strcpy(logfile, argv[arg]);
00443                   <font class="keywordflow">break</font>;
00444 
00445                 <font class="keywordflow">case</font> <font class="charliteral">'L'</font>:
00446                     stderr_log=1;
00447                     <font class="keywordflow">break</font>;
00448 
00449                 <font class="keywordflow">case</font> <font class="charliteral">'s'</font>:
00450                     syslog_log=1;
00451                     <font class="keywordflow">break</font>;
00452 
00453                 <font class="keywordflow">case</font> <font class="charliteral">'A'</font>:
00454                     dont_zero_log = 1;
00455                     <font class="keywordflow">break</font>;
00456 
00457                 <font class="keywordflow">case</font> <font class="charliteral">'I'</font>:
00458                   <font class="keywordflow">if</font> (++arg == argc) usage(argv[0]);
00459                   <a class="code" href="mib__modules_8h.html#a2">add_to_init_list</a>(argv[arg]);
00460                   <font class="keywordflow">break</font>;
00461 
00462 <font class="preprocessor">#if HAVE_UNISTD_H</font>
00463                 <font class="keywordflow">case</font> <font class="charliteral">'u'</font>:
00464                   <font class="keywordflow">if</font> (++arg == argc) usage(argv[0]);
00465                   ds_set_int(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a9">DS_AGENT_USERID</a>,atoi(argv[arg]));
00466                   <font class="keywordflow">break</font>;
00467                 <font class="keywordflow">case</font> <font class="charliteral">'g'</font>:
00468                   <font class="keywordflow">if</font> (++arg == argc) usage(argv[0]);
00469                   ds_set_int(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a10">DS_AGENT_GROUPID</a>, atoi(argv[arg]));
00470                   <font class="keywordflow">break</font>;
00471 <font class="preprocessor">#endif</font>
00472                 <font class="keywordflow">case</font> <font class="charliteral">'h'</font>:
00473                   usage(argv[0]);
00474                   <font class="keywordflow">break</font>;
00475                 <font class="keywordflow">case</font> <font class="charliteral">'H'</font>:
00476                   ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a2">DS_AGENT_NO_ROOT_ACCESS</a>, 1);
00477                   <a class="code" href="snmp__vars_8h.html#a11">init_agent</a>(<font class="stringliteral">"snmpd"</font>);   <font class="comment">/* register our .conf handlers */</font>
00478                   <a class="code" href="mib__modules_8c.html#a4">init_mib_modules</a>();
00479                   init_snmp(<font class="stringliteral">"snmpd"</font>);
00480                   fprintf(stderr, <font class="stringliteral">"Configuration directives understood:\n"</font>);
00481                   read_config_print_usage(<font class="stringliteral">"  "</font>);
00482                   exit(0);
00483                 <font class="keywordflow">case</font> <font class="charliteral">'v'</font>:
00484                   printf(<font class="stringliteral">"\nUCD-snmp version:  %s\n"</font>,VersionInfo);
00485                   printf(<font class="stringliteral">"Web:               http://www.net-snmp.org/\n"</font>);
00486                   printf(<font class="stringliteral">"Email:             net-snmp-coders@lists.sourceforge.net\n\n"</font>);
00487                   exit (0);
00488                 <font class="keywordflow">case</font> <font class="charliteral">'-'</font>:
00489                   <font class="keywordflow">switch</font>(argv[arg][2]){
00490                     <font class="keywordflow">case</font> <font class="charliteral">'v'</font>: 
00491                       printf(<font class="stringliteral">"\nUCD-snmp version:  %s\n"</font>,VersionInfo);
00492                       printf(<font class="stringliteral">"Web:               http://www.net-snmp.org/\n"</font>);
00493                       printf(<font class="stringliteral">"Email:             net-snmp-coders@lists.sourceforge.net\n\n"</font>);
00494                       exit (0);
00495                     <font class="keywordflow">case</font> <font class="charliteral">'h'</font>:
00496                       usage(argv[0]);
00497                       exit(0);
00498                   }
00499 
00500                 <font class="keywordflow">default</font>:
00501                   fprintf(stderr, <font class="stringliteral">"%s: Invalid option: %s\n"</font>, argv[0], argv[arg]);
00502                   usage(argv[0]);
00503                   <font class="keywordflow">break</font>;
00504               }
00505               <font class="keywordflow">continue</font>;
00506             }
00507             <font class="keywordflow">else</font> {
00508               fprintf(stderr, <font class="stringliteral">"%s: Bad argument: %s\n"</font>, argv[0], argv[arg]);
00509               exit(1);
00510             }
00511         }  <font class="comment">/* end-for */</font>
00512 
00513         <font class="comment">/* honor selection of standard error output */</font>
00514         <font class="keywordflow">if</font> (!stderr_log)
00515                 snmp_disable_stderrlog();
00516 
00517         <font class="comment">/* </font>
00518          * Initialize a argv set to the current for restarting the agent.
00519          */
00520         <a class="code" href="snmpd_8c.html#a12">argvrestartp</a> = (<font class="keywordtype">char</font> **) malloc((argc + 2) * <font class="keyword">sizeof</font>(<font class="keywordtype">char</font> *));
00521         argvptr = <a class="code" href="snmpd_8c.html#a12">argvrestartp</a>;
00522         <font class="keywordflow">for</font> (i = 0, ret = 1; i &lt; argc; i++) {
00523                 ret += strlen(argv[i]) + 1;
00524         }
00525         <a class="code" href="snmpd_8c.html#a13">argvrestart</a> = (<font class="keywordtype">char</font> *) malloc(ret);
00526         <a class="code" href="snmpd_8c.html#a14">argvrestartname</a> = (<font class="keywordtype">char</font> *) malloc(strlen(argv[0]) + 1);
00527         strcpy(<a class="code" href="snmpd_8c.html#a14">argvrestartname</a>, argv[0]);
00528         <font class="keywordflow">if</font> (agent_mode == -1) {
00529             <font class="keywordflow">if</font> ( strstr(<a class="code" href="snmpd_8c.html#a14">argvrestartname</a>, <font class="stringliteral">"agentxd"</font>) != NULL )
00530                 ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a1">DS_AGENT_ROLE</a>, <a class="code" href="snmpd_8h.html#a1">SUB_AGENT</a>);
00531             <font class="keywordflow">else</font>
00532                 ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a1">DS_AGENT_ROLE</a>, <a class="code" href="snmpd_8h.html#a0">MASTER_AGENT</a>);
00533         } <font class="keywordflow">else</font> {
00534             ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a1">DS_AGENT_ROLE</a>, agent_mode);
00535         }
00536         
00537         <font class="keywordflow">for</font> (cptr = <a class="code" href="snmpd_8c.html#a13">argvrestart</a>, i = 0; i &lt; argc; i++) {
00538                 strcpy(cptr, argv[i]);
00539                 *(argvptr++) = cptr;
00540                 cptr += strlen(argv[i]) + 1;
00541         }
00542         *cptr = 0;
00543         *argvptr = NULL;
00544 
00545         <font class="comment">/* </font>
00546          * Open the logfile if necessary.
00547          */
00548 
00549         <font class="comment">/* Should open logfile and/or syslog based on arguments */</font>
00550         <font class="keywordflow">if</font> (logfile[0])
00551                 snmp_enable_filelog(logfile, dont_zero_log);
00552         <font class="keywordflow">if</font> (syslog_log)
00553                 snmp_enable_syslog(); 
00554 <font class="preprocessor">#ifdef BUFSIZ</font>
00555         setvbuf(stdout, NULL, _IOLBF, BUFSIZ);
00556 <font class="preprocessor">#endif</font>
00557     <font class="comment">/* </font>
00558      * Initialize the world.  Detach from the shell.
00559      * Create initial user.
00560      */
00561 <font class="preprocessor">#if HAVE_FORK</font>
00562     <font class="keywordflow">if</font> (!dont_fork &amp;&amp; fork() != 0)<font class="keyword"> </font>{
00563       exit(0);
00564     }
00565 <font class="preprocessor">#endif</font>
00566 
00567 <font class="preprocessor">#if HAVE_GETPID</font>
00568     <font class="keywordflow">if</font> (pid_file != NULL) {
00569       <font class="keywordflow">if</font> ((PID = fopen(pid_file, <font class="stringliteral">"w"</font>)) == NULL) {
00570         snmp_log_perror(<font class="stringliteral">"fopen"</font>);
00571         <font class="keywordflow">if</font> (!ds_get_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a2">DS_AGENT_NO_ROOT_ACCESS</a>))
00572           exit(1);
00573       }
00574       <font class="keywordflow">else</font> {
00575         fprintf(PID, <font class="stringliteral">"%d\n"</font>, (<font class="keywordtype">int</font>)getpid());
00576         fclose(PID);
00577       }
00578     }
00579 <font class="preprocessor">#endif</font>
00580 
00581     SOCK_STARTUP;
00582     <a class="code" href="snmp__vars_8h.html#a11">init_agent</a>(<font class="stringliteral">"snmpd"</font>);                <font class="comment">/* do what we need to do first. */</font>
00583     <a class="code" href="mib__modules_8c.html#a4">init_mib_modules</a>();
00584     
00585 
00586     <font class="comment">/* start library */</font>
00587     init_snmp(<font class="stringliteral">"snmpd"</font>);
00588 
00589     <font class="keywordflow">if</font> ((ret = <a class="code" href="snmp__agent_8c.html#a31">init_master_agent</a>()) != 0) {
00590       <font class="comment">/*  Some error opening one of the specified agent transports.  */</font>
00591       Exit(1); <font class="comment">/*  Exit logs exit val for us  */</font>
00592     }
00593 
00594 <font class="preprocessor">#ifdef SIGTERM</font>
00595     signal(SIGTERM, <a class="code" href="snmpd_8c.html#a21">SnmpdShutDown</a>);
00596 <font class="preprocessor">#endif</font>
00597 <font class="preprocessor">#ifdef SIGINT</font>
00598     signal(SIGINT, <a class="code" href="snmpd_8c.html#a21">SnmpdShutDown</a>);
00599 <font class="preprocessor">#endif</font>
00600 <font class="preprocessor">#ifdef SIGHUP</font>
00601     signal(SIGHUP, SnmpdReconfig);
00602 <font class="preprocessor">#endif</font>
00603 <font class="preprocessor">#ifdef SIGUSR1</font>
00604     signal(SIGUSR1, SnmpdDump);
00605 <font class="preprocessor">#endif</font>
00606 <font class="preprocessor">#ifdef SIGPIPE</font>
00607     signal(SIGPIPE, SIG_IGN);   <font class="comment">/* 'Inline' failure of wayward readers */</font>
00608 <font class="preprocessor">#endif</font>
00609 
00610     <font class="comment">/* store persistent data immediately in case we crash later */</font>
00611     snmp_store(<font class="stringliteral">"snmpd"</font>);
00612 
00613     <font class="comment">/* send coldstart trap via snmptrap(1) if possible */</font>
00614     <a class="code" href="agent__trap_8h.html#a0">send_easy_trap</a> (0, 0);
00615         
00616 <font class="preprocessor">#if HAVE_UNISTD_H</font>
00617 <font class="preprocessor">#ifdef HAVE_SETGID</font>
00618         <font class="keywordflow">if</font> ((gid = ds_get_int(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a10">DS_AGENT_GROUPID</a>)) != 0) {
00619                 DEBUGMSGTL((<font class="stringliteral">"snmpd"</font>, <font class="stringliteral">"Changing gid to %d.\n"</font>, gid));
00620                 <font class="keywordflow">if</font> (setgid(gid)==-1)<font class="keyword"> </font>{
00621                         snmp_log_perror(<font class="stringliteral">"setgid failed"</font>);
00622                         <font class="keywordflow">if</font> (!ds_get_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a2">DS_AGENT_NO_ROOT_ACCESS</a>))
00623                             exit(1);
00624                 }
00625         }
00626 <font class="preprocessor">#endif</font>
00627 <font class="preprocessor">#ifdef HAVE_SETUID</font>
00628         <font class="keywordflow">if</font> ((uid = ds_get_int(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a9">DS_AGENT_USERID</a>)) != 0) {
00629                 DEBUGMSGTL((<font class="stringliteral">"snmpd"</font>, <font class="stringliteral">"Changing uid to %d.\n"</font>, uid));
00630                 <font class="keywordflow">if</font>(setuid(uid)==-1)<font class="keyword"> </font>{
00631                         snmp_log_perror(<font class="stringliteral">"setuid failed"</font>);
00632                         <font class="keywordflow">if</font> (!ds_get_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a2">DS_AGENT_NO_ROOT_ACCESS</a>))
00633                             exit(1);
00634                 }
00635         }
00636 <font class="preprocessor">#endif</font>
00637 <font class="preprocessor">#endif</font>
00638 
00639         <font class="comment">/* we're up, log our version number */</font>
00640         snmp_log(LOG_INFO, <font class="stringliteral">"UCD-SNMP version %s\n"</font>, VersionInfo);
00641         <a class="code" href="snmp__agent_8c.html#a26">snmp_addrcache_initialise</a>();
00642         <font class="comment">/* </font>
00643          * Forever monitor the dest_port for incoming PDUs.
00644          */
00645         DEBUGMSGTL((<font class="stringliteral">"snmpd"</font>, <font class="stringliteral">"We're up.  Starting to process data.\n"</font>));
00646         receive();
00647 <font class="preprocessor">#include "mib_module_shutdown.h"</font>
00648         DEBUGMSGTL((<font class="stringliteral">"snmpd"</font>, <font class="stringliteral">"sending shutdown trap\n"</font>));
00649         SnmpTrapNodeDown();
00650         DEBUGMSGTL((<font class="stringliteral">"snmpd"</font>, <font class="stringliteral">"Bye...\n"</font>));
00651         snmp_shutdown(<font class="stringliteral">"snmpd"</font>);
00652         <font class="keywordflow">return</font> 0;
00653 
00654 }  <font class="comment">/* End main() -- snmpd */</font>
</pre></div>    </td>
  </tr>
</table>
<a name="a18" doxytag="snmpd.c::main"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int main </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp;, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname">&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a16" doxytag="snmpd.c::snmp_input"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int snmp_input </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>op</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_session *&nbsp;</td>
          <td class="mdname">&nbsp; <em>session</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>reqid</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_pdu *&nbsp;</td>
          <td class="mdname">&nbsp; <em>pdu</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname">&nbsp; <em>magic</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00883">883</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.<div class="fragment"><pre>00888 {
00889     <font class="keyword">struct </font><a class="code" href="structget__req__state.html">get_req_state</a> *state = (struct get_req_state *)magic;
00890     
00891     <font class="keywordflow">if</font> (op == SNMP_CALLBACK_OP_RECEIVED_MESSAGE) {
00892         <font class="keywordflow">if</font> (pdu-&gt;command == SNMP_MSG_GET) {
00893             <font class="keywordflow">if</font> (state-&gt;<a class="code" href="structget__req__state.html#m0">type</a> == <a class="code" href="m2m_8h.html#a1">EVENT_GET_REQ</a>) {
00894                 <font class="comment">/* this is just the ack to our inform pdu */</font>
00895                 <font class="keywordflow">return</font> 1;
00896             }
00897         }
00898     }
00899     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (op == SNMP_CALLBACK_OP_TIMED_OUT) {
00900         <font class="keywordflow">if</font> (state-&gt;<a class="code" href="structget__req__state.html#m0">type</a> == <a class="code" href="m2m_8h.html#a0">ALARM_GET_REQ</a>) {
00901                 <font class="comment">/* Need a mechanism to replace obsolete SNMPv2p alarm */</font>
00902         }
00903     }
00904     <font class="keywordflow">return</font> 1;
00905 
00906 } <font class="comment">/* end snmp_input() */</font>
</pre></div>    </td>
  </tr>
</table>
<a name="a15" doxytag="snmpd.c::snmp_read_packet"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int snmp_read_packet </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a name="a13" doxytag="snmpd.c::argvrestart"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char* argvrestart
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00171">171</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<a name="a14" doxytag="snmpd.c::argvrestartname"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char* argvrestartname
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00172">172</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<a name="a12" doxytag="snmpd.c::argvrestartp"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char** argvrestartp
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00170">170</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<a name="a11" doxytag="snmpd.c::reconfig"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int reconfig = 0
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00167">167</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<a name="a10" doxytag="snmpd.c::running"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int running = 1
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00166">166</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<a name="a9" doxytag="snmpd.c::snmp_dump_packet"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int snmp_dump_packet
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmpd_8c-source.html#l00165">165</a> of file <a class="el" href="snmpd_8c-source.html">snmpd.c</a>.    </td>
  </tr>
</table>
<hr><address><small>Generated on Sat Nov 10 14:09:56 2001 for net-snmp by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.11 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
<!--#include virtual="/sfbutton.html" -->
<!--#include virtual="/sfbutton.html" -->
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

