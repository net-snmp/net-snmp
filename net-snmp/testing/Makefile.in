#
# Makefile for testing
#

#TARG		= etest ktest misctest stest

USELIBS		= ../snmplib/libsnmp.$(LIB_EXTENSION)$(LIB_VERSION)
LIBS		= -L../snmplib $(CC_RUNTIME_ARG) -lsnmp @LIBS@

PARSEOBJS	=

CPPFLAGS	= -I.. -I$(srcdir)/.. -I$(srcdir)/../snmplib @CPPFLAGS@
CC		= @CC@ $(CPPFLAGS)

all: $(TARG)

test:
	$(srcdir)/RUNTESTS -a -D `pwd`/..

etest:    etimetest.o $(PARSEOBJS) $(USELIBS)
	${CC} -o $@ etimetest.o $(PARSEOBJS) ${LDFLAGS} ${LIBS} 

ktest:    keymanagetest.o $(PARSEOBJS) $(USELIBS)
	${CC} -o $@ keymanagetest.o $(PARSEOBJS) ${LDFLAGS} ${LIBS} 

misctest:    misctest.o $(PARSEOBJS) $(USELIBS)
	${CC} -o $@ misctest.o $(PARSEOBJS) ${LDFLAGS} ${LIBS} 

stest:    scapitest.o $(PARSEOBJS) $(USELIBS)
	${CC} -o $@ scapitest.o $(PARSEOBJS) ${LDFLAGS} ${LIBS} 

clean:
	rm -f *.o core *.core $(TARG)
	-rm -fr /tmp/snmp-test*

install: installdirs $(TARG)
	@for i in $(TARG) ; \
		do $(INSTALL) $$i $(bindir) ; \
		echo "install:  installed $$i in $(bindir)" ; \
	done

installdirs:
	@$(SHELL) $(srcdir)/../mkinstalldirs $(snmplibdir) $(bindir)

dependlocal: 
	makedepend $(CPPFLAGS) -o.lo $(srcdir)/*.c

depend: dependlocal

nosysdepend: 
	makedepend $(CPPFLAGS) -o.lo *.c
	perl -n -i.bak $(top_srcdir)/makenosysdepend.pl Makefile

makefileindepend: nosysdepend
	perl $(top_srcdir)/makefileindepend.pl


# DO NOT DELETE THIS LINE -- make depend depends on it.

etimetest.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
etimetest.lo: ../m/generic.h  
etimetest.lo:  ./../snmplib/asn1.h
etimetest.lo: ./../snmplib/snmp_api.h ./../snmplib/tools.h
etimetest.lo: ./../snmplib/lcd_time.h ./../snmplib/snmp_debug.h
etimetest.lo: ./../snmplib/callback.h
keymanagetest.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
keymanagetest.lo: ../m/generic.h  
keymanagetest.lo:  ./../snmplib/asn1.h
keymanagetest.lo: ./../snmplib/snmp_api.h ./../snmplib/keytools.h
keymanagetest.lo: ./../snmplib/tools.h ./../snmplib/scapi.h
keymanagetest.lo: ./../snmplib/transform_oids.h ./../snmplib/callback.h
misctest.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
misctest.lo: ../m/generic.h  
misctest.lo:  ./../snmplib/asn1.h
misctest.lo: ./../snmplib/snmp_api.h ./../snmplib/tools.h
misctest.lo: ./../snmplib/transform_oids.h ./../snmplib/callback.h
scapitest.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
scapitest.lo: ../m/generic.h  
scapitest.lo:  ./../snmplib/asn1.h
scapitest.lo: ./../snmplib/snmp_api.h ./../snmplib/keytools.h
scapitest.lo: ./../snmplib/tools.h ./../snmplib/scapi.h
scapitest.lo: ./../snmplib/transform_oids.h ./../snmplib/callback.h
T.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
